(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{266:function(e,t,n){var content=n(331);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(132).default)("08e35723",content,!0,{sourceMap:!1})},330:function(e,t,n){"use strict";n(266)},331:function(e,t,n){var r=n(131)(!1);r.push([e.i,"body,html{margin:0;padding:0;font-family:Arial,Helvetica,sans-serif}*{box-sizing:border-box}#map-2{left:0;height:100%;width:75%;padding:0;border-width:0;margin:0;overflow:hidden}#map-2,#sidebar{position:absolute;top:0}#sidebar{bottom:0;right:0;width:25%;padding:1rem}.select{width:100%;height:30px}.mapboxgl-ctrl-group button{color:#000}button{border:1px solid #000;padding:.5rem;cursor:pointer}button:disabled{border-color:#7f828b;color:#7f828b;cursor:default}#selected-ids{width:300px;height:300px;white-space:pre-line}",""]),e.exports=r},335:function(e,t,n){"use strict";n.r(t);n(44),n(43),n(19),n(36),n(77),n(78);var r=n(30),o=n(336),c=n(21),l=n(12),d=(n(60),n(37),n(74),n(75),n(46),n(110),n(76),n(184),n(59),n(34),n(268),n(275),n(277),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(38),n(190),n(293),n(186),n(1)),h=n(297),m=n(298),v=n.n(m),f=n(255),y=(n(300),n(302)),_=n.n(y),C=n(329),F=n(325),S=n.n(F),x=(n(326),n(334)),O=n(328);function w(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function k(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?w(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):w(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var E=d.a.extend({data:function(){return{map:void 0,coords:{lng:-99.35,lat:40},rangeOnly:!1,resolution:3,draw:void 0,filtered:[],children:[],selected:[],filteredBase:[],filteredChildren:[],copied:!1,drawMode:!1,species:"aldfly",options:[{text:"Alder Flycatcher",value:"aldfly"},{text:"Western Tanager",value:"westan"}],season:"breeding",seasonOptions:[{text:"Breeding",value:"breeding"},{text:"Nonbreeding",value:"nonbreeding"},{text:"Prebreeding migration",value:"prebreeding_migration"},{text:"Postbreeding migration",value:"postbreeding_migration"}],seasonText:{breeding:"Breeding",nonbreeding:"Nonbreeding",prebreeding_migration:"Prebreeding migration",postbreeding_migration:"Postbreeding migration"},styleOptions:[{text:"Street",value:"streets-v11"},{text:"Satellite",value:"satellite-streets-v11"}],confirmSpeciesChange:!1,displayMsg:!1,deselectLasso:!1,speciesChangeEvent:void 0,lastEvent:{event:void 0,ids:[],layers:[],children:{}},pastActions:[],metadata:{},popup:void 0,style:"streets-v11",count:0,savedData:{},speciesData:{},exported:!1,sessionData:{}}},computed:{selectedOutput:function(){return JSON.stringify(this.seasonSelected)},seasonFilter:function(){return["==",["get","season"],this.season]},actionNumber:function(){return this.pastActions.length-this.count},seasonSelected:function(){return this.sessionData[this.species][this.season].selected},seasonFilteredBase:function(){return this.sessionData[this.species][this.season].filteredBase},seasonFilteredChildren:function(){return this.sessionData[this.species][this.season].filteredChildren},seasonChildren:function(){return this.sessionData[this.species][this.season].children}},watch:{selected:function(){},pastActions:function(){this.count=0},style:function(){var e=this;this.map.setStyle("mapbox://styles/mapbox/".concat(this.style)),this.map.once("style.load",(function(){e.map.off("click",[e.species,"children"],e.mapClick),e.map.off("contextmenu",[e.species,"children"],e.mapRightClick),e.updateLayer(!1)}))},season:function(){this.resetLayer(this.species,!0),this.exported=!1,this.map.setFilter("".concat(this.species,"_checklists"),this.seasonFilter)},confirmSpeciesChange:function(e){var t=this;e&&(this.exported=!1,this.confirmSpeciesChange=!1,this.displayMsg&&(this.displayMsg=!1),this.map.setLayoutProperty(this.speciesChangeEvent.oldVal,"visibility","none"),this.map.setLayoutProperty("".concat(this.speciesChangeEvent.oldVal,"_checklists"),"visibility","none"),this.map.off("click",[this.speciesChangeEvent.oldVal,"children"],this.mapClick),this.map.off("contextmenu",[this.speciesChangeEvent.oldVal,"children"],this.mapRightClick),this.updateLayer(),this.checkTileData(this.metadata,this.speciesChangeEvent.newVal).then((function(){t.setChildFeatures()})))},species:function(e,t){}},mounted:function(){var e=this;h.accessToken="pk.eyJ1IjoibGF1cmVub2xkaGFtMTIwMiIsImEiOiJjaW55dm52N2gxODJrdWtseWZ5czAyZmp5In0.YkEUt6GvIDujjudu187eyA",this.map=new h.Map({container:"map-2",style:"mapbox://styles/mapbox/".concat(this.style),center:this.coords,zoom:1,doubleClickZoom:!1,boxZoom:!1,dragRotate:!1}),this.map.doubleClickZoom.disable(),this.draw=new S.a({displayControlsDefault:!1,defaultMode:this.drawMode?"draw_polygon":"simple_select",controls:{polygon:!0},modes:Object.assign(S.a.modes,{draw_polygon:x.a})}),this.map.addControl(this.draw,"top-left"),this.map.addControl(new h.ScaleControl({maxWidth:900})),this.map.addControl(new h.NavigationControl),this.map.on("load",(function(){e.map.addSource("children",{type:"geojson",data:{type:"FeatureCollection",features:[]},promoteId:"h3_address"}),e.map.addLayer({id:"children",source:"children",type:"fill",paint:{"fill-opacity":.3,"fill-color":["case",["boolean",["feature-state","selected"],!1],"deeppink","black"]},layout:{"fill-sort-key":["+",["get","h3_address"]]}}),e.updateLayer(),e.map.on("zoom",(function(){}))}))},methods:{zoomToExtent:function(){var e=this.metadata[this.species].bounding_box;if(e){var t=[e.lon_min,e.lat_min],n=[e.lon_max,e.lat_max];t[0]-n[0]>0&&(t=[-179,t[1]],n=[179,n[1]]);var r=[t,n];this.map.fitBounds(r,{padding:100})}},updateLayer:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.popup&&this.popup.remove(),this.map.getSource(this.species)?(this.resetLayer(this.species,!0),this.seasonSelected.map((function(t){e.map.setFeatureState({source:e.species,sourceLayer:e.species,id:t},{selected:!0})})),this.map.setLayoutProperty(this.species,"visibility","visible"),this.map.setLayoutProperty("".concat(this.species,"_checklists"),"visibility","visible")):(this.metadata[this.species]||this.fetchTileData(),this.checkTileData(this.metadata,this.species).then((function(){e.sessionData[e.species]||(e.sessionData[e.species]={});var n=e.metadata[e.species].season_dates;e.seasonOptions.forEach((function(t){var text=Object.keys(n).includes(t.value)?"".concat(n[t.value].start_date," to ").concat(n[t.value].end_date):"unavailable";t.text="".concat(e.seasonText[t.value]," (").concat(text,")"),e.sessionData[e.species].hasOwnProperty(t.value)||(e.sessionData[e.species][t.value]={selected:[],filteredBase:[],filteredChildren:[],children:[]})})),e.map.addSource(e.species,{type:"vector",promoteId:"h3_address",tiles:["https://test.cdn.shorebirdviz.ebird.org/range_editor/".concat(e.species,"_v3/{z}/{x}/{y}.pbf")],maxzoom:8});var r="streets-v11"===e.style,o=t?["get","in_range"]:["match",["get","h3_address"],e.sessionData[e.species][e.season].selected,!0,!1],c=r?"black":"white",l=r?.3:["case",["boolean",["feature-state","selected"],o],.5,.2];e.map.addLayer({id:e.species,source:e.species,"source-layer":e.species,type:"fill",filter:e.seasonFilter,layout:{visibility:"visible"},paint:{"fill-color":["case",["boolean",["feature-state","selected"],o],"deeppink","black"],"fill-outline-color":["case",["boolean",["feature-state","selected"],o],"deeppink",c],"fill-opacity":l}}),e.map.addLayer({id:"".concat(e.species,"_checklists"),source:e.species,"source-layer":"".concat(e.species,"_checklists"),type:"circle",filter:e.seasonFilter,layout:{visibility:"visible","circle-sort-key":["+",["get","count"]]},paint:{"circle-opacity":["match",["get","count"],0,.3,1,.7,.7],"circle-color":["match",["get","count"],0,"#9c4363",1,"#4405ff","#4405ff"],"circle-radius":{property:"count",stops:[[0,2],[1,3],[5,6],[10,12],[100,16]]},"circle-stroke-width":1,"circle-stroke-color":["match",["get","count"],0,"transparent",1,"whitesmoke","whitesmoke"]}}),e.map.on("mousemove","".concat(e.species,"_checklists"),(function(e){console.log(e.features[0].source,e.features[0].properties)})),t?(e.resetSelected(),e.zoomToExtent()):(e.map.addSource("children",{type:"geojson",data:{type:"FeatureCollection",features:[]},promoteId:"h3_address"}),e.map.addLayer({id:"children",source:"children",type:"fill",paint:{"fill-color":["case",["boolean",["feature-state","selected"],o],"deeppink","black"],"fill-outline-color":["case",["boolean",["feature-state","selected"],o],"deeppink",c],"fill-opacity":l},layout:{"fill-sort-key":["+",["get","h3_address"]]}}),e.filterOutParentHexes(e.species,e.seasonFilteredBase),e.filterOutParentHexes("children",e.seasonFilteredChildren),e.setChildFeatures(),e.seasonSelected.map((function(t){e.map.setFeatureState({source:e.species,sourceLayer:e.species,id:t},{selected:!0})})),e.seasonSelected.map((function(t){e.map.setFeatureState({source:"children",id:t},{selected:!0})})))})),this.map.on("mousedown",(function(t){var n=t.originalEvent,r=n.ctrlKey;(n.shiftKey||r)&&e.draw.changeMode("draw_polygon"),e.deselectLasso=r})),this.map.on("mouseup",(function(){e.draw.changeMode("simple_select")})),this.map.on("draw.create",this.drawCreate),this.map.on("draw.modechange",(function(t){setTimeout((function(){e.drawMode=Boolean("draw_polygon"===t.mode)}),10)})),this.popup=new h.Popup({closeButton:!1}),this.map.on("mousemove",[this.species,"children"],(function(e){}))),this.map.on("click",[this.species,"children"],this.mapClick),this.map.on("contextmenu",[this.species,"children"],this.mapRightClick)},checkTileData:function(e,t){return new Promise((function(n){!function r(){if(e[t])return n();setTimeout(r,30)}()}))},fetchTileData:function(){var e=this,t="https://test.cdn.shorebirdviz.ebird.org/range_editor/".concat(this.species,"/range_editor.json");_.a.get(t).then(function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.data;case 2:e.metadata[e.species]=t.sent;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))},disableSeason:function(e){if(this.metadata[this.species])return!this.metadata[this.species].in_range_addresses[e]},resetSelected:function(){var e=this.metadata[this.species].in_range_addresses[this.season];e&&!this.sessionData[this.species][this.season].selected.length?this.sessionData[this.species][this.season].selected=JSON.parse(JSON.stringify(e)):console.log("SEASON NOT AVAILABLE FOR ".concat(this.species))},resetLayer:function(e,t){var n=this;this.map.getSource("children")&&this.map.getSource(e)&&(Object.entries(this.sessionData[this.species]).forEach((function(t){var r=Object(c.a)(t,2),o=(r[0],r[1]);o.filteredBase.length&&(o.filteredBase.forEach((function(t){n.map.setFeatureState({source:e,sourceLayer:e,id:t},{selected:!1})})),o.selected.map((function(e){n.map.setFeatureState({source:"children",id:e},{selected:!1})}))),o.selected.length&&(o.selected.map((function(t){n.map.setFeatureState({source:e,sourceLayer:e,id:t},{selected:!1})})),o.selected.map((function(e){n.map.setFeatureState({source:"children",id:e},{selected:!1})})))})),this.filterOutParentHexes(e,this.seasonFilteredBase,e),this.filterOutParentHexes("children",this.seasonFilteredChildren),this.setChildFeatures(),t&&(this.resetSelected(),Object.entries(this.sessionData[this.species]).forEach((function(e){var t=Object(c.a)(e,2),r=t[0],o=t[1];o.selected.length&&r===n.season&&(o.selected.map((function(e){n.map.setFeatureState({source:n.species,sourceLayer:n.species,id:e},{selected:!0})})),o.selected.map((function(e){n.map.setFeatureState({source:"children",id:e},{selected:!0})})))})),this.displayMsg=!1),this.pastActions=[])},onSpeciesChange:function(input){var e=this;this.speciesChangeEvent={oldVal:input.srcElement._value,newVal:input.target.value};var t=!1;Object.entries(this.sessionData[this.speciesChangeEvent.oldVal]).forEach((function(n){var r=Object(c.a)(n,2),o=r[0],l=r[1];l.selected.length&&l.selected.length!==e.metadata[e.speciesChangeEvent.oldVal].in_range_addresses[o].length&&(t=!0)})),t?(this.displayMsg=!0,this.species=this.speciesChangeEvent.newVal):(console.log("update from ".concat(this.speciesChangeEvent.oldVal," to ").concat(this.speciesChangeEvent.newVal)),this.speciesChange())},speciesChange:function(){this.confirmSpeciesChange=!0,this.species=this.speciesChangeEvent.newVal,this.displayMsg=!1},uniqueValues:function(e){return Array.from(new Set(e))},setChildFeatures:function(){this.sessionData[this.species][this.season].children=this.uniqueValues(this.seasonChildren);var e=v.a.h3SetToFeatureCollection(this.seasonChildren,(function(e){return{h3_address:e}}));e.features.forEach((function(e){var polygon=e.geometry.coordinates;polygon[0].forEach((function(e,i){if(i<polygon[0].length-1){var t=polygon[0][i+1][0],n=e[0];t-n<=-180?polygon[0][i+1][0]+=360:t-n>=180&&(polygon[0][i+1][0]-=360)}}))})),this.map.getSource("children").setData(e)},filterOutParentHexes:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.species,r=["match",["get","h3_address"],t=this.uniqueValues(t),!1,!0];e===n?this.map.setFilter(e,t.length?["all",this.seasonFilter,r]:this.seasonFilter):this.map.setFilter(e,t.length?r:null)},removeItemFromArray:function(e,t){e.splice(e.indexOf(t),1)},arrayIncludesItem:function(e,t){return e.includes(t)},updateSelected:function(e){this.seasonSelected.includes(e.id)?this.removeItemFromArray(this.seasonSelected,e.id):this.seasonSelected.push(e.id)},getChildrenHexes:function(e,t){var n=[];return e.forEach((function(e){n.push.apply(n,Object(o.a)(f.h3ToChildren(e,t)))})),n},bboxToPixel:function(polygon){var e=Object(O.a)(polygon),t=this.map.project([e[2],e[3]]);return[this.map.project([e[0],e[1]]),t]},copyToClipboard:function(){var e=this;navigator.clipboard.writeText(this.sessionData),this.copied=!0,setTimeout((function(){e.copied=!1}),2e3)},saveLastEvent:function(e,t,n){this.lastEvent={event:e,ids:t,layers:n,children:{}}},drawCreate:function(e){var t=this,n=this.bboxToPixel(e.features[0]),r=this.map.queryRenderedFeatures(n,{layers:[this.species,"children"]}),o=[];r.forEach((function(t){var n=C.polygon(t.geometry.coordinates),r=C.intersect(n,C.polygon(e.features[0].geometry.coordinates),{properties:t.properties});r&&o.push(r)})),this.lastEvent={event:this.deselectLasso?"lasso_deselect":"lasso_select",ids:[],layers:[this.species,"children"],children:{}},this.pastActions.push({event:this.deselectLasso?"lasso_deselect":"lasso_select",ids:[],layers:[this.species,"children"],children:{}}),o.forEach((function(e){t.seasonSelected.includes(e.properties.h3_address)||t.deselectLasso?t.seasonSelected.includes(e.properties.h3_address)&&t.deselectLasso&&(t.removeItemFromArray(t.seasonSelected,e.properties.h3_address),t.pastActions[t.pastActions.length-1].ids.push(e.properties.h3_address)):(t.seasonSelected.push(e.properties.h3_address),t.lastEvent.ids.push(e.properties.h3_address),t.pastActions[t.pastActions.length-1].ids.push(e.properties.h3_address)),t.map.setFeatureState({source:t.species,sourceLayer:t.species,id:e.properties.h3_address},{selected:!t.deselectLasso}),t.map.setFeatureState({source:"children",id:e.properties.h3_address},{selected:!t.deselectLasso})})),this.draw.delete(e.features[0].id)},mapClick:function(e){var t=this;if(!this.drawMode){var n=!e.originalEvent.shiftKey,r=e.features[0],c=parseInt(r.id[1])+1;if(n){var l=r.properties.in_range,d=!this.seasonSelected.includes(r.id)&&l,h=!Object.keys(r.state).length&&l,m=d||(h?!l:!r.state.selected);this.map.setFeatureState(k(k({source:r.source},r.source===this.species&&{sourceLayer:this.species}),{},{id:r.id}),{selected:m}),this.updateSelected(r),this.lastEvent={event:this.map.getFeatureState(k(k({source:r.source},r.source===this.species&&{sourceLayer:this.species}),{},{id:r.id})).selected?"click_select":"click_deselect",ids:[r.id],layers:[r.source],children:{}},this.pastActions.push({event:this.map.getFeatureState(k(k({source:r.source},r.source===this.species&&{sourceLayer:this.species}),{},{id:r.id})).selected?"click_select":"click_deselect",ids:[r.id],layers:[r.source],children:{}})}else if(c<=5){var v,y=f.h3ToChildren(r.id,c);(v=this.seasonChildren).push.apply(v,Object(o.a)(y)),this.setChildFeatures(),r.source===this.species?this.seasonFilteredBase.push(r.id):this.seasonFilteredChildren.push(r.id);var _=this.arrayIncludesItem(this.seasonSelected,r.id);y.forEach((function(e){_&&(t.map.setFeatureState({source:"children",id:e},{selected:!0}),t.seasonSelected.push(e)),t.seasonFilteredChildren.includes(e)&&t.removeItemFromArray(t.seasonFilteredChildren,e),t.seasonFilteredBase.includes(e)})),_&&(this.map.setFeatureState({source:"children",id:r.id},{selected:!1}),this.removeItemFromArray(this.seasonSelected,r.id)),r.source===this.species?this.filterOutParentHexes(this.species,this.seasonFilteredBase):this.filterOutParentHexes("children",this.seasonFilteredChildren),this.arrayIncludesItem(this.seasonChildren,r.id)&&this.removeItemFromArray(this.seasonChildren,r.id),this.lastEvent={event:_?"click_expand_selected":"click_expand_deselected",ids:[r.id],layers:[r.source],children:{}},this.pastActions.push({event:_?"click_expand_selected":"click_expand_deselected",ids:[r.id],layers:[r.source],children:{}})}}},mapRightClick:function(e){var t=this,n=e.originalEvent;if(!this.drawMode&&!n.ctrlKey&&0!==n.button){var r=this.map.queryRenderedFeatures(e.point,{layers:[this.species,"children"]})[0],source=r.source;if(r){var c=f.h3GetResolution(r.id);if(c>=3){var l,d=f.h3ToParent(r.id,c-1);if(source===this.species){var h=v.a.h3ToFeature(d);l=this.map.queryRenderedFeatures(this.bboxToPixel(h),{layers:[this.species]})}this.seasonChildren.push(d),this.map.setFeatureState({source:"children",id:d},{selected:this.arrayIncludesItem(this.seasonSelected,r.id)}),this.arrayIncludesItem(this.seasonSelected,r.id)&&this.seasonSelected.push(d),this.lastEvent={event:this.arrayIncludesItem(this.seasonSelected,r.id)?"click_collapse_selected":"click_collapse_deselected",ids:[d],layers:[r.source],children:{}},this.pastActions.push({event:this.arrayIncludesItem(this.seasonSelected,r.id)?"click_collapse_selected":"click_collapse_deselected",ids:[d],layers:[r.source],children:{}});var m,y,_=[];if([2,3,4,5].forEach((function(e){e>=c&&_.push.apply(_,Object(o.a)(f.h3ToChildren(d,e)))})),source===this.species&&l.forEach((function(e){_.includes(e.id)&&(t.lastEvent.children[e.id]=t.seasonSelected.includes(e.id),t.pastActions[t.pastActions.length-1].children[e.id]=t.seasonSelected.includes(e.id))})),_.forEach((function(e){t.seasonChildren.includes(e)&&(t.lastEvent.children[e]=t.seasonSelected.includes(e),t.pastActions[t.pastActions.length-1].children[e]=t.seasonSelected.includes(e),t.removeItemFromArray(t.seasonChildren,e)),t.seasonSelected.includes(e)&&(t.removeItemFromArray(t.seasonSelected,e),t.map.setFeatureState({source:"children",id:e},{selected:!1}))})),source===this.species)(m=this.seasonFilteredBase).push.apply(m,_),this.filterOutParentHexes(this.species,this.seasonFilteredBase);else this.removeItemFromArray(this.seasonFilteredChildren,d),this.filterOutParentHexes("children",this.seasonFilteredChildren),(y=this.seasonFilteredBase).push.apply(y,_),this.filterOutParentHexes(this.species,this.seasonFilteredBase);this.setChildFeatures()}else console.log("CANNOT COLLAPSE FOR RES",c)}}},undo:function(e){var t=this,n=e.event,r=e.ids,source=e.layers;if("lasso_select"===n)r.forEach((function(e){t.removeItemFromArray(t.seasonSelected,e),t.map.setFeatureState({source:"children",id:e},{selected:!1}),t.map.setFeatureState({source:t.species,sourceLayer:t.species,id:e},{selected:!1})}));else if("lasso_deselect"===n)r.forEach((function(e){t.seasonSelected.push(e),t.map.setFeatureState({source:"children",id:e},{selected:!0}),t.map.setFeatureState({source:t.species,sourceLayer:t.species,id:e},{selected:!0})}));else if("click_collapse_selected"===n){var c,l=this.seasonFilteredBase.includes(r[0])?"children":source[0],d=r[0],h=Object.keys(e.children);(c=this.seasonChildren).push.apply(c,h),this.setChildFeatures(),l===this.species?this.seasonFilteredBase.push(d):this.seasonFilteredChildren.push(d);var m=this.arrayIncludesItem(this.seasonSelected,d);h.forEach((function(n){t.map.setFeatureState({source:"children",id:n},{selected:e.children[n]}),!t.seasonSelected.includes(n)&&e.children[n]?t.seasonSelected.push(n):t.seasonSelected.includes(n)&&!e.children[n]&&t.removeItemFromArray(t.seasonSelected,d),t.seasonFilteredChildren.includes(n)&&t.removeItemFromArray(t.seasonFilteredChildren,n)})),m&&(this.map.setFeatureState({source:"children",id:d},{selected:!1}),this.removeItemFromArray(this.seasonSelected,d)),l===this.species?(this.seasonFilteredChildren.push(d),this.filterOutParentHexes("children",this.seasonFilteredChildren),this.filterOutParentHexes(this.species,this.seasonFilteredBase)):this.filterOutParentHexes("children",this.seasonFilteredChildren),this.arrayIncludesItem(this.seasonChildren,d)&&this.removeItemFromArray(this.seasonChildren,d)}else if("click_collapse_deselected"===n){var v,y=this.seasonFilteredBase.includes(r[0])?"children":source[0],_=r[0],C=Object.keys(e.children);(v=this.seasonChildren).push.apply(v,C),this.setChildFeatures(),y===this.species?this.seasonFilteredBase.push(_):this.seasonFilteredChildren.push(_);var F=this.arrayIncludesItem(this.seasonSelected,_);C.forEach((function(n){t.map.setFeatureState({source:"children",id:n},{selected:e.children[n]}),!t.seasonSelected.includes(n)&&e.children[n]?t.seasonSelected.push(n):t.seasonSelected.includes(n)&&!e.children[n]&&t.removeItemFromArray(t.seasonSelected,_),t.seasonFilteredChildren.includes(n)&&t.removeItemFromArray(t.seasonFilteredChildren,n)})),F&&(this.map.setFeatureState({source:"children",id:_},{selected:!1}),this.removeItemFromArray(this.seasonSelected,_)),y===this.species?(this.seasonFilteredChildren.push(_),this.filterOutParentHexes("children",this.seasonFilteredChildren),this.filterOutParentHexes(this.species,this.seasonFilteredBase)):this.filterOutParentHexes("children",this.seasonFilteredChildren),this.arrayIncludesItem(this.seasonChildren,_)&&this.removeItemFromArray(this.seasonChildren,_)}else if("click_expand_selected"===n){var S=r[0],x=f.h3GetResolution(S);this.seasonChildren.push(S),this.seasonSelected.includes(S)||this.seasonSelected.push(S),this.map.setFeatureState({source:"children",id:S},{selected:!0});var O,w,E=f.h3ToChildren(S,x+1);if(E.forEach((function(e){t.seasonChildren.includes(e)&&t.removeItemFromArray(t.seasonChildren,e),t.seasonSelected.includes(e)&&(t.removeItemFromArray(t.seasonSelected,e),t.map.setFeatureState({source:"children",id:e},{selected:!1}))})),source[0]===this.species)(O=this.seasonFilteredBase).push.apply(O,Object(o.a)(E)),this.filterOutParentHexes(this.species,this.seasonFilteredBase);else this.removeItemFromArray(this.seasonFilteredChildren,S),this.filterOutParentHexes("children",this.seasonFilteredChildren),(w=this.seasonFilteredBase).push.apply(w,Object(o.a)(E)),this.filterOutParentHexes(this.species,this.seasonFilteredBase);this.setChildFeatures()}else if("click_expand_deselected"===n){var I=r[0],A=f.h3GetResolution(I);this.seasonChildren.push(I);var L,P,j=f.h3ToChildren(I,A+1);if(j.forEach((function(e){t.seasonChildren.includes(e)&&t.removeItemFromArray(t.seasonChildren,e),t.seasonSelected.includes(e)&&(t.removeItemFromArray(t.seasonSelected,e),t.map.setFeatureState({source:"children",id:e},{selected:!1}))})),source[0]===this.species)(L=this.seasonFilteredBase).push.apply(L,Object(o.a)(j)),this.filterOutParentHexes(this.species,this.seasonFilteredBase);else this.removeItemFromArray(this.seasonFilteredChildren,I),this.filterOutParentHexes("children",this.seasonFilteredChildren),(P=this.seasonFilteredBase).push.apply(P,Object(o.a)(j)),this.filterOutParentHexes(this.species,this.seasonFilteredBase);this.setChildFeatures()}else if("click_select"===n){var D=this.seasonFilteredBase.includes(r[0])?"children":source[0];this.removeItemFromArray(this.seasonSelected,r[0]),this.map.setFeatureState(k(k({source:D},D===this.species&&{sourceLayer:this.species}),{},{id:r[0]}),{selected:!1})}else if("click_deselect"===n){var T,B=this.seasonFilteredBase.includes(r[0])?"children":source[0];(T=this.seasonSelected).push.apply(T,Object(o.a)(r)),this.map.setFeatureState(k(k({source:B},B===this.species&&{sourceLayer:this.species}),{},{id:r[0]}),{selected:!0})}},undoTest:function(){this.count++,this.actionNumber>=0&&this.undo(this.pastActions[this.actionNumber]),this.removeItemFromArray(this.pastActions,this.pastActions[this.actionNumber])},download:function(){var e=this,t=this.speciesChangeEvent?this.speciesChangeEvent.oldVal:this.species,n={};Object.keys(this.sessionData[t]).forEach((function(r){n[r]=e.sessionData[t][r].selected}));var r=new Blob([JSON.stringify(n)],{type:"text/json"}),o=document.createElement("a");o.href=window.URL.createObjectURL(r),o.download="".concat(t,".json"),o.click(),URL.revokeObjectURL(o.href),setTimeout((function(){e.exported=!0,e.confirmSpeciesChange=!0}),1e3)},save:function(){this.savedData[this.species]||(this.savedData[this.species]={}),this.savedData[this.species][this.season]={selected:this.seasonSelected,filteredChildren:this.seasonFilteredChildren,filteredBase:this.seasonFilteredBase,children:this.seasonChildren},console.log(this.savedData)}}}),I=E,A=(n(330),n(56)),component=Object(A.a)(I,(function(){var e,t=this,n=t._self._c;t._self._setupProxy;return n("div",{staticStyle:{display:"flex"}},[n("div",{attrs:{id:"map-2"}}),t._v(" "),n("div",{attrs:{id:"sidebar"}},[n("span",[t._v("Select a species:")]),t._v(" "),n("br"),t._v(" "),n("select",{staticClass:"select",domProps:{value:t.species},on:{input:t.onSpeciesChange}},t._l(t.options,(function(option){return n("option",{domProps:{value:option.value}},[t._v("\n                "+t._s(option.text)+"\n              ")])})),0),t._v(" "),n("br"),t._v(" "),n("br"),t._v(" "),n("span",[t._v("Select a season:")]),t._v(" "),n("br"),t._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.season,expression:"season"}],staticClass:"select",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));t.season=e.target.multiple?n:n[0]}}},t._l(t.seasonOptions,(function(option){return n("option",{attrs:{disabled:t.disableSeason(option.value)},domProps:{value:option.value}},[t._v("\n          "+t._s(option.text)+"\n        ")])})),0),t._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:t.disableSeason(t.season),expression:"disableSeason(season)"}],staticStyle:{color:"red","font-weight":"500"}},[t._v("\n        "+t._s(t.season)+" season UNAVAILABLE for "+t._s(t.species)+"\n      ")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.displayMsg,expression:"displayMsg"}],staticClass:"alert-msg",staticStyle:{border:"1px solid",margin:"1rem 0"},style:{borderColor:t.exported?"#cc3340":"#bd580a"}},[n("div",{staticClass:"header",staticStyle:{color:"white",padding:"0.5rem","font-weight":"500"},style:{background:t.exported?"#cc3340":"#bd580a"}},[t.exported?t._e():n("div",[n("strong",[t._v("Export "+t._s(t.seasonText[null===(e=t.speciesChangeEvent)||void 0===e?void 0:e.oldVal])+" species data?")])]),t._v(" "),t.exported?n("div",[n("strong",[t._v("Confirm species change")])]):t._e()]),t._v(" "),n("div",{staticClass:"body",staticStyle:{padding:"0.5rem",display:"flex","flex-direction":"column"},style:{background:t.exported?"#f6e4e5":"#f4e8df"}},[t.exported?t._e():n("div",[t._v("\n            You must export current species data before changing species.\n            ")]),t._v(" "),t.exported?n("div",[t._v("\n            Check that your download was successful and confirm species change.\n          ")]):t._e(),t._v(" "),n("div",{staticClass:"button-menu",staticStyle:{"margin-left":"auto","margin-top":"0.75rem"}},[n("button",{on:{click:function(e){t.confirmSpeciesChange=!1,t.displayMsg=!1,t.species=t.speciesChangeEvent.oldVal}}},[t._v("Cancel")]),t._v(" "),n("button",{directives:[{name:"show",rawName:"v-show",value:!t.exported,expression:"!exported"}],on:{click:t.download}},[t._v("Export")]),t._v(" "),n("button",{directives:[{name:"show",rawName:"v-show",value:t.exported,expression:"exported"}],on:{click:t.speciesChange}},[t._v("Change species")])])])]),t._v(" "),n("br"),n("br"),t._v(" "),n("label",{attrs:{for:"basemap"}},[t._v("Basemap: ")]),n("br"),t._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.style,expression:"style"}],staticClass:"select",attrs:{id:"basemap"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));t.style=e.target.multiple?n:n[0]}}},t._l(t.styleOptions,(function(option){return n("option",{domProps:{value:option.value}},[t._v("\n          "+t._s(option.text)+"\n        ")])})),0),t._v(" "),n("hr"),t._v("\n      # selected hexes: "),t.sessionData[t.species]&&t.seasonSelected?n("strong",[t._v(t._s(t.seasonSelected.length))]):t._e(),t._v(" "),n("br"),n("br"),t._v(" "),n("button",{attrs:{disabled:t.actionNumber<=0},on:{click:t.undoTest}},[t._v("UNDO LAST ACTION")]),t._v(" "),n("button",{on:{click:t.download}},[t._v("save species data")]),t._v(" "),n("hr"),t._v(" "),t._m(0)])])}),[function(){var e=this,t=e._self._c;e._self._setupProxy;return t("span",{staticStyle:{"line-height":"30px"}},[e._v("\n        SELECT: "),t("strong",[e._v("CLICK")]),e._v(" a grey hex\n        "),t("br"),e._v("\n        DESELECT: "),t("strong",[e._v("CLICK")]),e._v(" a pink hex\n        "),t("br"),e._v("\n        REFINE: "),t("strong",[e._v("CLICK + SHIFT")]),e._v(" "),t("br"),e._v("\n        COLLAPSE: "),t("strong",[e._v("RIGHT CLICK")]),e._v(" "),t("br"),e._v("\n        LASSO SELECT: "),t("strong",[e._v("SHIFT + DRAG")]),e._v(" "),t("br"),e._v("\n        LASSO DESELECT: "),t("strong",[e._v("CTRL + DRAG")])])}],!1,null,null,null);t.default=component.exports}}]);