/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{1050:function(t,e,r){"use strict";r.r(e);var n=r(10),l=(r(32),r(42),r(231),r(41),r(120),r(36),r(11),r(29),r(726)),o=r(76),h=r.n(o),c={name:"CloStackedAreaChart",data:function(){return{keyOrder:[],overlayLineData:null,overlayLineDataNoScale:null,dataModel:{},maxYValue:0,minYValue:0,domainYMin:null,domainYMax:null,displayError:!1,xTickLabelInterval:4,hoveredData:null,areaChartSvg:null,xScale:null,yScale:null,topLevelKeys:null,areaNames:null,areaNamesReversed:null,posData:null,negData:null,dataModelPositive:null,dataModelNegative:null,arrayForX:[],arrayForXNeg:[],margin:{top:20,right:20,bottom:20,left:20},areaColors:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]}},props:{apiUrl:{type:String,required:!1},chartData:{type:Object,required:!1},hasKeyClasses:{type:String,required:!1,default:"false"},minY:{type:String,required:!1,default:"-1"},maxY:{type:String,required:!1,default:"1"},overlayLineField:{type:String,required:!1,default:"scaledAbundanceData"},overlayLineFieldNoScale:{type:String,required:!1,default:"abundanceData"},xIncomingDateFormat:{type:String,required:!1,default:"ddmm"}},watch:{dataModel:function(data){this.updateChart()}},computed:{},beforeMount:function(){this.domainYMin=this.minY,this.domainYMax=this.maxY},mounted:function(){var t=this;this.formatApiDataForDisplay(),document.addEventListener("lichen:resize",(function(){t.updateChart()}))},methods:{updateChart:function(){this.drawSVG(),this.drawPositiveAreas(),null!=this.overlayLineData&&this.drawOverlayLine()},setAreaNames:function(){this.topLevelKeys=Object.keys(this.dataModel),this.areaSortField&&this.keyOrder.length>0?this.areaNames=this.keyOrder:this.areaNames=Object.keys(this.dataModel[this.topLevelKeys[0]]),this.areaNamesReversed=this.areaNames.slice(0),this.areaNamesReversed.reverse()},prepareData:function(){this.arrayForX=[],this.arrayForXNeg=[];for(var i=0;i<this.topLevelKeys.length;i++){this.posData={},this.negData={},this.posData.index=i;for(var t=0;t<this.areaNames.length;t++){(e=this.dataModel[this.topLevelKeys[i]][this.areaNames[t]])>=0?(e>this.maxYValue&&(this.maxYValue=this.maxYValue+e),this.posData[this.areaNames[t]]=e):this.posData[this.areaNames[t]]=0}for(t=0;t<this.areaNamesReversed.length;t++){var e;(e=this.dataModel[this.topLevelKeys[i]][this.areaNamesReversed[t]])>=0?this.negData[this.areaNamesReversed[t]]=0:(e<this.minYValue&&(this.minYValue=this.minYValue+e),this.negData[this.areaNamesReversed[t]]=e)}this.arrayForX.push(this.posData),this.arrayForXNeg.push(this.negData)}},formatApiDataForDisplay:function(){var t=this,e=null;void 0!==this.chartData&&this.chartData?this.prepChartData(this.chartData):h()({url:this.apiUrl,method:"get",headers:this.habitatApiHeader?{"X-eBirdApiToken":this.habitatApiHeader}:""}).then((function(r){e=r.data,t.prepChartData(e)})).catch((function(e){console.log(e),t.displayError=!0}))},prepChartData:function(t){if(this.areaSortField){var e=t[this.areaSortField],r=[];if(e){for(var n in e)r.push([n,e[n]]);r.sort((function(a,b){return a[1].displayOrder-b[1].displayOrder}));for(var i=0;i<r.length;i++)this.keyOrder.push(r[i][0])}}null!=this.overlayLineField&&(this.overlayLineData=t[this.overlayLineField]),null!=this.overlayLineFieldNoScale&&(this.overlayLineDataNoScale=t[this.overlayLineFieldNoScale]);var l=this.fixNumericLeadingZeroKeys(t.data);this.dataModel=l,this.postFetchData()},postFetchData:function(){this.setAreaNames(),this.prepareData(),this.drawSVG(),this.drawPositiveAreas(),null!=this.overlayLineField&&this.drawOverlayLine()},drawSVG:function(){for(var t=this,element=this.$el;element.firstChild;)element.removeChild(element.firstChild);var e=this.dataModel,r=Object.keys(e).length,n=element.offsetWidth-this.margin.left-this.margin.right,o=element.offsetHeight-this.margin.top-this.margin.bottom;this.xScale=l.k().range([this.margin.left-2,n-this.margin.right]).domain([-.1,r-.8]);var h=this.domainYMin?this.domainYMin:this.minYValue-.1,c=this.domainYMax?this.domainYMax:this.maxYValue+.1;this.yScale=l.k().range([o-this.margin.top,this.margin.bottom]).domain([h,c]),this.areaChartSvg=l.m(element).append("svg").attr("width",element.offsetWidth-this.margin.left).attr("height",element.offsetHeight).append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")");var d=this.$el.getBoundingClientRect().width-4*this.margin.right,f=(this.areaChartSvg.append("rect").attr("x",this.margin.left-1).attr("y",this.margin.top).attr("x2",n-this.margin.left).attr("width",d).attr("height",o-this.margin.top-this.margin.bottom).attr("fill","lightgray").attr("opacity","0.4").attr("id",this.$el.id+"StackedAreaChart-background"),null);l.k().range([this.margin.left-2,n-this.margin.right]).domain([0,r-1]);if(this.xIncomingDateFormat){var C=null;f=l.b(this.xScale).ticks(r-1).tickFormat((function(i){if(i<r-1){var t=Object.keys(e)[i],n=t.length,l=t.substring(0,n-2);if(C==l)return"";var o=new Date("January 1, 2000 12:00:00");o.setMonth(l-1);var h=navigator.language?navigator.language:"en";return C=l,o.toLocaleDateString(h,{month:"narrow"})}return""}))}else f=l.b(this.xScale).ticks(r).tickFormat((function(i){if(!t.xIncomingDateFormat)return Object.keys(e)[i]}));var S=l.c(this.yScale).ticks(2);this.areaChartSvg.append("svg:g").attr("class","x axis").attr("transform","translate(0,"+(o-this.margin.bottom)+")").call(f),this.areaChartSvg.append("svg:g").attr("class","y axis").attr("transform","translate("+this.margin.left+",0)").call(S),l.n(".tick text").attr("class","StackedAreaChart-axisText");this.areaChartSvg.append("line").attr("x1",this.margin.left).attr("y1",o/2-this.margin.bottom+this.margin.top).attr("x2",n-this.margin.left).attr("y2",o/2-this.margin.bottom+this.margin.top).attr("stroke-width",2).attr("stroke","#fff");this.addXAxisHovers()},addXAxisHovers:function(){var t=this,e=document.getElementById(this.$el.id+"StackedAreaChart-background"),r=e.getBoundingClientRect().height;l.n("g.x.axis").selectAll("g.tick").select("line").attr("class",(function(e,i){if(Object.keys(t.dataModel)[e])return"StackedAreaChart-habitatSelectionLine StackedAreaChart-habitatSelectionLine"+i})).attr("id",(function(t,i){return"StackedAreaChart-habitatSelectionLine"+i})).attr("y2",-r).style("stroke","transparent").style("stroke-width",e.getBoundingClientRect().width/Object.keys(this.dataModel).length).style("visibility","hidden").on("mouseover",(function(e,i){var r=Object.keys(t.dataModel)[e];l.m("#StackedAreaChart-habitatSelectionCenterLine"+i).style("visibility","visible");var n=new CustomEvent("stackedareachart",{detail:{key:r,data:t.dataModel[r],other:t.overlayLineData[r],otherNoScale:t.overlayLineDataNoScale[r]}});document.dispatchEvent(n)})).on("mouseout",(function(t,i){l.m("#StackedAreaChart-habitatSelectionCenterLine"+i).style("visibility","hidden");var e=new CustomEvent("stackedareachart-mouseout");document.dispatchEvent(e)})),l.n("g.x.axis").selectAll("g.tick").append("line").attr("id",(function(t,i){return"StackedAreaChart-habitatSelectionCenterLine"+i})).attr("y2",-r).style("stroke","#000").style("pointer-events","none").on("mouseover",(function(t,i){l.m(this).style("visibility","visible")})).on("mouseout",(function(t,i){l.m(this).style("visibility","hidden");new CustomEvent("stackedareachart-mouseout")})).style("stroke-width","2px").style("visibility","hidden")},drawOverlayLine:function(){var t=this,e=l.f().x((function(e,i){return t.xScale(i)})).y((function(e){return t.yScale(e.y)})),r=this.fixNumericLeadingZeroKeys(this.overlayLineData);this.overlayLineData=r;var o=this.fixNumericLeadingZeroKeys(this.overlayLineDataNoScale);this.overlayLineDataNoScale=o;var output=Object.entries(this.overlayLineData).map((function(t){var e=Object(n.a)(t,2);return{x:e[0],y:e[1]}}));this.areaChartSvg.append("path").attr("d",e(output)).attr("stroke","black").attr("stroke-width",2).attr("fill","none")},fixNumericLeadingZeroKeys:function(data){var t={};return Object.keys(data).forEach((function(e){var r=e;isNaN(e)||(r=+e),t[r]=data[e]})),t},drawPositiveAreas:function(){var t=this,e=l.o();e.keys(this.areaNames),e.order(l.q),e.offset(l.p);var area=l.a().x((function(e,i){return t.xScale(i)})).y0((function(e){return t.yScale(e[0])})).y1((function(e){return t.yScale(e[1])})),r=this.areaChartSvg.selectAll(".StackedAreaChart-area").data(e(this.arrayForX)).enter().append("g").attr("class",(function(t){return"StackedAreaChart-area "+t.key})).append("path").attr("class",(function(t,i){return"StackedAreaChart-area StackedAreaChart-area-"+i})).style("pointer-events","none").attr("d",area),n=this.areaChartSvg.selectAll(".StackedAreaChart-area-neg").data(e(this.arrayForXNeg)).enter().append("g").attr("class",(function(t){return"StackedAreaChart-area-neg "+t.key})).append("path").attr("class",(function(t,i){return"StackedAreaChart-area-neg StackedAreaChart-area-neg-"+i})).style("pointer-events","none").attr("d",area);"false"===this.hasKeyClasses?(r.style("fill",(function(e,i){return t.areaColors[i]})),n.style("fill",(function(e,i){return t.areaColors[i]}))):(r.attr("class",(function(t,i){return"u-color-habitat-"+t.key})),n.attr("class",(function(t,i){return"u-color-habitat-"+t.key})))}}},d=(r(933),r(2)),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"StackedAreaChart"},[t.displayError?r("div",[t._v("There was en error fetching chart data.")]):t._e()])}),[],!1,null,null,null);e.default=component.exports},721:function(t,e,r){var content=r(934);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(14).default)("6f31eb3e",content,!0,{sourceMap:!1})},933:function(t,e,r){"use strict";r(721)},934:function(t,e,r){var n=r(13)(!1);n.push([t.i,'@-webkit-keyframes pulse{0%,to{opacity:1}50%{opacity:.5}}@keyframes pulse{0%,to{opacity:1}50%{opacity:.5}}.StackedAreaChart{height:100%;min-height:320px}.StackedAreaChart .tick{stroke-width:3}.StackedAreaChart .tick line{stroke:#fff;opacity:.7}.StackedAreaChart .axis path{stroke:none}.StackedAreaChart .line{fill:none;opacity:.6;stroke-width:2px}.StackedAreaChart-habitatSelectionLine{width:"50px";pointer-events:all}.StackedAreaChart-axisText{fill:#6a6a6a;font-size:.75rem;line-height:1.2}.StackedAreaChart-axisText--sm{font-size:.625rem}.StackedAreaChart .u-color-habitat-INTERTIDAL_FS_C1{fill:#c6dbef}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C1{fill:#fffbd1}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C2{fill:#807dba}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C11{fill:#48d8ae}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C12{fill:#19ab81}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C13{fill:#88da4a}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C14{fill:#5ab01a}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C15{fill:#0f7d70}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C16{fill:#0e772b}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C21{fill:#9db216}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C22{fill:#c6dd2f}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C31{fill:#cec608}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C32{fill:#f6ed15}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C41{fill:#ce9708}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C42{fill:#dbbe92}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS1_FS_C43{fill:#f6b715}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS2_FS_C25{fill:#eb9565}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS2_FS_C35{fill:#e66eb6}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS2_FS_C36{fill:#f16363}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS3_FS_C27{fill:#901174}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS3_FS_C50{fill:#9f35b9}.StackedAreaChart .u-color-habitat-MCD12Q1_LCCS3_FS_C51{fill:#bcbddc}.StackedAreaChart .u-color-habitat-GP_RTP{fill:#858585}.StackedAreaChart .u-color-habitat-ASTWBD_FS_C1{fill:#084594}.StackedAreaChart .u-color-habitat-ASTWBD_FS_C2{fill:#6baed6}.StackedAreaChart .u-color-habitat-ASTWBD_FS_C3{fill:#2171b5}.StackedAreaChart .u-color-habitat-NTL{fill:#000}',""]),t.exports=n}}]);