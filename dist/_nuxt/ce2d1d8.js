/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{1039:function(e,t,l){"use strict";l.r(t);l(470),l(36),l(91);var o=l(76),r=l.n(o),n=l(26),d=l(526),h={components:{CloIcon:n.default,CloLightbox:d.default},data:function(){return{active:!1,lightboxKey:"lightboxKey",lightboxOpen:!1,goToAsset:null,gap:1,mediaList:[],totalDone:0,rows:[],loading:!1,error:!1,height:null,forceImageSize:640,small:{height:null,forceImageSize:640},medium:{height:null,forceImageSize:640}}},props:{list:{type:Array,default:function(){return[]}},dataFormat:{type:String,default:"search"},url:{type:String,default:null},mediaDownloadUrl:{default:"https://cdn.download.ams.birds.cornell.edu/api/v1/asset/",type:String},mediaSpecimenUrl:{default:"https://macaulaylibrary.org/asset/",type:String},caption:{type:String,default:"species"},responsiveImages:{type:Boolean,default:!0},rowHeightForSmall:{type:Number,default:null},rowHeightForMedium:{type:Number,default:null},integratedLightbox:{type:Boolean,default:!1},externalLightbox:{type:Boolean,default:!1},ratingEnabled:{type:Boolean,default:!1},getRatingsUrl:{type:String,default:"/rating-api?assetIds="},saveRatingUrl:{type:String,default:"/rating-api"},ratingApiHeader:{type:String,default:null},ratingCsrf:{type:String,default:null},speciesLinks:{type:Boolean,default:!0},animationSpeed:{type:Number,default:.3}},beforeMount:function(){this.refreshSize()},computed:{sixteenByNine:function(){return 16/9}},watch:{rowHeightForSmall:function(){this.refreshSize(),this.refresh()},rowHeightForMedium:function(){this.refreshSize(),this.refresh()},list:function(){this.mediaList=this.list,this.prepareList(),this.refresh()},url:function(){this.getListFromUrl()}},mounted:function(){this.containerWidth=this.$el.offsetWidth,this.url?this.getListFromUrl():(this.mediaList=this.list,this.initialize()),document.addEventListener("lichen:resize",this.handleResize)},beforeDestroy:function(){document.removeEventListener("lichen:resize",this.handleResize)},methods:{handleResize:function(){this.$el.offsetWidth!==this.containerWidth&&(this.containerWidth=this.$el.offsetWidth,this.refreshSize(),this.refresh())},getListFromUrl:function(){var e=this;this.loading=!0,this.error=!1,r.a.get(this.url).then((function(t){e.mediaList=t.data.results.content;var l=new CustomEvent("lichen:resultsgallery-numresults",{detail:{numResults:t.data.results.count}});document.dispatchEvent(l),e.initialize(),e.loading=!1})).catch((function(){e.loading=!1,e.error=!0}))},prepareList:function(){var e=this;this.mediaList.forEach((function(t,l){"search"===e.dataFormat&&(t.mediaType=t.mediaType.toLowerCase(),t.taxonomy={comName:t.commonName,sciName:t.sciName},t.valid="false"!==t.valid,t.assetState="asset_"+t.assetState),"audio"===t.mediaType?e.mediaList[l].ratio=32/11:"video"===t.mediaType?e.mediaList[l].ratio=e.sixteenByNine:t.width&&t.height&&(e.mediaList[l].ratio=t.width/t.height)}))},refreshSize:function(){window.innerWidth<768?(this.rowHeightForSmall&&(this.height=this.rowHeightForSmall),this.responsiveImages||(this.forceImageSize=480)):this.rowHeightForMedium?(this.height=this.rowHeightForMedium,this.responsiveImages||(this.forceImageSize=900)):this.responsiveImages||(this.forceImageSize=480)},initialize:function(){this.prepareList(),this.calculateHeight(),this.addRow(0,0,this.mediaList.length)},refresh:function(){this.rows=[],this.totalDone=0,this.calculateHeight(),this.addRow(0,0,this.mediaList.length)},mouseover:function(e,t){this.rows[e][t].showCaption=!0,this.$forceUpdate()},mouseout:function(e,t){this.rows[e][t].showCaption=!1,this.$forceUpdate()},loaded:function(e){e.target.classList.add("show")},errored:function(e){var t=this;this.rows.forEach((function(l,o){l.forEach((function(l,r){e===l.assetId&&(t.rows[o][r].error=!0)}))})),this.$forceUpdate()},calculateHeight:function(){if(!this.height){var e=this.$el.offsetWidth;this.height=e/6.3,this.height<150&&(this.height=150)}},addItem:function(e,t,l){var o=this.mediaList[t],r=this.mediaList[t].ratio;r>3&&(r=3,o.crop=!0);var n={width:l*r-this.gap+"px",height:l+"px"};o.calc=n,o.showCaption=!1,this.totalDone++,this.rows[e].push(o)},addRow:function(e,t,l){var o=this,r=this.calculateRow(t,l);if(r){this.rows[e]=[];for(var i=t;i<t+r.count&&i<this.mediaList.length;i++)this.addItem(e,i,r.height);this.$forceUpdate(),this.totalDone<this.mediaList.length&&this.addRow(e+1,this.totalDone,l)}else setTimeout((function(){o.addRow(e,t,l)}),100)},calculateRow:function(e,t){for(var l=this,o=0,i=e,r=0,n=this.$el.offsetWidth,d=!0;i<t&&o<=n;)if(this.mediaList[i].hasOwnProperty("ratio")){var h=this.mediaList[i].ratio;h>3&&(h=3),o+=this.height*h-this.gap,i++,r++}else{var c=this.sixteenByNine;o+=this.height*c-this.gap;var m=this.mediaList[i];m.hasOwnProperty("width")&&m.hasOwnProperty("height")&&null!=m.width&&null!=m.height?m.ratio=m.width/m.height:function(){var img=new Image;img.onload=function(){l.mediaList[img.lichenIndex].width=img.width,l.mediaList[img.lichenIndex].height=img.height,l.mediaList[img.lichenIndex].ratio=img.width/img.height},img.onerror=function(){l.mediaList[img.lichenIndex].width=16,l.mediaList[img.lichenIndex].height=9,l.mediaList[img.lichenIndex].ratio=l.sixteenByNine,l.mediaList[img.lichenIndex].error=!0},img.lichenIndex=i,l.forceImageSize?(img.src=l.mediaDownloadUrl+m.assetId+"/"+l.forceImageSize,l.mediaList[img.lichenIndex].forceImageSize=l.forceImageSize):img.src=l.mediaDownloadUrl+m.assetId+"/160"}(),i++,r++,d=!1}return!!d&&(o>=n?{height:n/(o/this.height)-this.gap,count:r}:{height:.8*this.height,count:r})},openLightbox:function(e,t){this.integratedLightbox&&!e.metaKey?(e.preventDefault(),this.goToAsset=t,this.lightboxOpen=!0):this.externalLightbox&&!e.metaKey&&(e.preventDefault(),this.$emit("open-lightbox",t))},closeLightbox:function(){this.lightboxOpen=!1}}},c=(l(917),l(2)),component=Object(c.a)(h,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"ResultsGallery"},[l("div",{staticClass:"ResultsGallery-background",style:{paddingTop:e.gap+"px"}},[e._l(e.rows,(function(t,o){return l("div",{key:o,staticClass:"ResultsGallery-row",style:{marginLeft:e.gap+"px"}},e._l(t,(function(t,r){return l("a",{key:r,ref:"asset-"+t.assetId,refInFor:!0,staticClass:"ResultsGallery-link",attrs:{href:e.mediaSpecimenUrl+t.assetId,"data-asset-id":t.assetId},on:{mouseover:function(t){return e.mouseover(o,r)},mouseout:function(t){return e.mouseout(o,r)},focus:function(t){return e.mouseover(o,r)},blur:function(t){return e.mouseout(o,r)},click:function(l){return l.ctrlKey||l.shiftKey||l.altKey||l.metaKey?null:e.openLightbox(l,t.assetId)}}},[l("figure",{staticClass:"ResultsGallery-figure",style:{marginRight:e.gap+"px",marginBottom:e.gap+"px"}},[t.error?l("div",{staticClass:"ResultsGallery-placeholder",style:t.calc},[l("div",[l("CloIcon",{attrs:{symbol:"timer"}}),e._v(" "),"photo"===t.mediaType?l("span",[e._v(e._s(e.$t("media.processingPhoto")))]):e._e(),e._v(" "),"audio"===t.mediaType?l("span",[e._v(e._s(e.$t("media.processingAudio")))]):e._e(),e._v(" "),"video"===t.mediaType?l("span",[e._v(e._s(e.$t("media.processingVideo")))]):e._e()],1)]):["photo"==t.mediaType&&e.responsiveImages?l("img",{staticClass:"ResultsGallery-image",class:{crop:t.crop},style:t.calc,attrs:{alt:t.taxonomy.comName+" - "+t.userDisplayName,sizes:t.calc.width,srcset:e.mediaDownloadUrl+t.assetId+"/160 160w,"+e.mediaDownloadUrl+t.assetId+"/320 320w,"+e.mediaDownloadUrl+t.assetId+"/480 480w,"+e.mediaDownloadUrl+t.assetId+"/640 640w,"+e.mediaDownloadUrl+t.assetId+"/900 900w,"+e.mediaDownloadUrl+t.assetId+"/1200 1200w",src:e.mediaDownloadUrl+t.assetId+"/480"},on:{load:e.loaded,error:function(l){return e.errored(t.assetId)}}}):e._e(),e._v(" "),"photo"!==t.mediaType||e.responsiveImages?e._e():l("img",{staticClass:"ResultsGallery-image",class:{crop:t.crop},style:t.calc,attrs:{alt:t.taxonomy.comName+" - "+t.userDisplayName,src:e.mediaDownloadUrl+t.assetId+"/"+e.forceImageSize},on:{load:e.loaded,error:function(l){return e.errored(t.assetId)}}}),e._v(" "),"audio"===t.mediaType?l("img",{staticClass:"ResultsGallery-image",class:{crop:t.crop},style:t.calc,attrs:{alt:t.taxonomy.comName+" - "+t.userDisplayName,src:e.mediaDownloadUrl+t.assetId+"/poster"},on:{load:e.loaded,error:function(l){return e.errored(t.assetId)}}}):e._e(),e._v(" "),"video"===t.mediaType?l("img",{staticClass:"ResultsGallery-image",class:{crop:t.crop},style:t.calc,attrs:{alt:t.taxonomy.comName+" - "+t.userDisplayName,src:e.mediaDownloadUrl+t.assetId+"/thumb"},on:{load:e.loaded,error:function(l){return e.errored(t.assetId)}}}):e._e()],e._v(" "),l("figcaption",{staticClass:"ResultsGallery-caption",class:{show:t.showCaption,withPlayButton:"photo"!==t.mediaType}},[t.valid?e._e():l("CloIcon",{staticClass:"ResultsGallery-icon",attrs:{symbol:"warning",size:"sm"}}),e._v(" "),t.assetRestricted||t.parentAssetId||"production"===t.collection?l("CloIcon",{staticClass:"ResultsGallery-icon",attrs:{symbol:"warning",size:"lockClosed"}}):e._e(),e._v(" "),"deleted"==t.assetState?l("CloIcon",{staticClass:"ResultsGallery-icon",attrs:{symbol:"delete",size:"sm"}}):e._e(),e._v(" "),"species"===e.caption?[l("span",[l("strong",[e._v(e._s(t.taxonomy.comName))])]),e._v(" "),l("span",[e._v("© "+e._s(t.userDisplayName))])]:[l("span",[l("strong",[e._v("© "+e._s(t.userDisplayName))])]),e._v(" "),l("span",[e._v("Macaulay Library")])]],2),e._v(" "),"photo"!==t.mediaType?l("div",{staticClass:"ResultsGallery-playButton",attrs:{"aria-hidden":"true"}},[l("CloIcon",{attrs:{symbol:"play",size:"sm"}})],1):e._e()],2)])})),0)})),e._v(" "),e.totalDone<e.mediaList.length||e.loading?l("div",{staticClass:"LoadingAnimation LoadingAnimation--showMore"},[l("CloIcon",{attrs:{symbol:"spinner"}})],1):e._e(),e._v(" "),e.error?l("div",{staticClass:"ResultsGallery-unavailable"},[l("div",[e._v(e._s(e.$t("generic.unavailable")))])]):e._e()],2),e._v(" "),e.lightboxOpen?l("CloLightbox",{attrs:{reverse:"",list:e.list,dataFormat:e.dataFormat,ratingEnabled:e.ratingEnabled,getRatingsUrl:e.getRatingsUrl,saveRatingUrl:e.saveRatingUrl,ratingCsrf:e.ratingCsrf,mediaDownloadUrl:e.mediaDownloadUrl,mediaSpecimenUrl:e.mediaSpecimenUrl,goTo:e.goToAsset,speciesLinks:e.speciesLinks,animationSpeed:e.animationSpeed},on:{close:e.closeLightbox}}):e._e()],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{CloIcon:l(26).default,CloLightbox:l(526).default})},710:function(e,t,l){var content=l(918);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,l(14).default)("041e6108",content,!0,{sourceMap:!1})},917:function(e,t,l){"use strict";l(710)},918:function(e,t,l){var o=l(13)(!1);o.push([e.i,"@-webkit-keyframes pulse{0%,to{opacity:1}50%{opacity:.5}}@keyframes pulse{0%,to{opacity:1}50%{opacity:.5}}.ResultsGallery{width:100%}.ResultsGallery .ResultsGallery-background{background-color:#fff}.ResultsGallery .ResultsGallery-row{display:flex;flex-direction:row;max-width:100%;overflow-x:hidden}.ResultsGallery .ResultsGallery-link{cursor:pointer;text-decoration:none}.ResultsGallery .ResultsGallery-figure{position:relative;margin:0}.ResultsGallery .ResultsGallery-caption{position:absolute;bottom:0;left:0;right:0;font-size:.75rem;line-height:1.333;padding:.25rem;color:#f8f8f8;background-color:rgba(33,33,33,.8);margin:0;opacity:0;transition:opacity .2s ease}.ResultsGallery .ResultsGallery-caption h1,.ResultsGallery .ResultsGallery-caption h2,.ResultsGallery .ResultsGallery-caption h3,.ResultsGallery .ResultsGallery-caption h4,.ResultsGallery .ResultsGallery-caption h5,.ResultsGallery .ResultsGallery-caption h6{color:#fff}.ResultsGallery .ResultsGallery-caption li,.ResultsGallery .ResultsGallery-caption p{color:#f8f8f8}.ResultsGallery .ResultsGallery-caption a:not(.Button){color:#8ad4ff}.ResultsGallery .ResultsGallery-caption a:active:not(.Button),.ResultsGallery .ResultsGallery-caption a:focus:not(.Button),.ResultsGallery .ResultsGallery-caption a:hover:not(.Button){color:#90d6ff}.ResultsGallery .ResultsGallery-caption.show{opacity:1}.ResultsGallery .ResultsGallery-caption.withPlayButton{padding-left:3rem}[dir=rtl] .ResultsGallery .ResultsGallery-caption.withPlayButton{padding-left:0;padding-right:3rem}.ResultsGallery .ResultsGallery-caption strong{padding-right:.5rem}[dir=rtl] .ResultsGallery .ResultsGallery-caption strong{padding-left:.5rem;padding-right:0}.ResultsGallery .ResultsGallery-image{display:block;max-width:none;transition:opacity .2s ease,transform .2s ease;opacity:0}.ResultsGallery .ResultsGallery-image.show{opacity:1}.ResultsGallery .ResultsGallery-image.crop{-o-object-fit:cover;object-fit:cover}.ResultsGallery .ResultsGallery-placeholder{background-color:#d6d6d6;display:flex;justify-content:center;align-items:center;color:#2f2f2f;font-size:.75rem;line-height:1.333}.ResultsGallery .ResultsGallery-placeholder .Icon{fill:#757575}.ResultsGallery .ResultsGallery-playButton{background-color:#007bc2;color:#fff;line-height:1;position:absolute;left:.5rem;bottom:.5rem;border-radius:3px;margin:0;padding:.25rem .5rem}[dir=rtl] .ResultsGallery .ResultsGallery-playButton{left:auto;right:.5rem}.ResultsGallery .ResultsGallery-icon{width:1rem;height:1rem;fill:#aa4f09}",""]),e.exports=o}}]);